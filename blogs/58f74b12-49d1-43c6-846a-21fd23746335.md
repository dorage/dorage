---
uuid: 58f74b12-49d1-43c6-846a-21fd23746335
description: 
title: [2438]Â Range Product Queries of Powers
tags: [ Contest, LeetCode, Medium ]
date: 2022-10-15T15:00:00.000Z
---







### ë§í¬

[Range Product Queries of Powers - LeetCode](https://leetcode.com/problems/range-product-queries-of-powers/)

### ğŸ“ ë¬¸ì œ

Given a positive integerÂ `n`, there exists aÂ **0-indexed**Â array calledÂ `powers`, composed of theÂ **minimum**Â number of powers ofÂ `2`Â that sum toÂ `n`. The array is sorted inÂ **non-decreasing**Â order, and there isÂ **only one**Â way to form the array.

You are also given aÂ **0-indexed**Â 2D integer arrayÂ `queries`, whereÂ `queries[i] = [lefti, righti]`. EachÂ `queries[i]`Â represents a query where you have to find the product of allÂ `powers[j]`Â withÂ `leftiÂ <= j <= righti`.

ReturnÂ *an array*Â `answers`*, equal in length to*Â `queries`*, where*Â `answers[i]`Â *is the answer to the*Â `ith`Â *query*. Since the answer to theÂ `ith`Â query may be too large, eachÂ `answers[i]`Â should be returnedÂ **modulo**Â `109Â + 7`.

*INPUT*

*OUTPUT*

```jsx
n = 15, queries = [[0,1],[2,2],[0,3]]
```

```jsx
[2,4,64]
```

### ğŸš¨ ì˜¤ë¥˜

<aside>
ğŸ•§

</aside>

### âœ”ï¸ í’€ì´

```jsx
const getPowers = (n) => {
    const powers = [];
    
    while(n) {
        let i = 0;
        while(2 ** i <= n) {
            i++;
        }
        powers.unshift(i - 1);
        n -= 2 ** (i - 1);
    }
    
    return powers;
}
const getSum = (power, min, max, memo) => {
    if(max === min) return power[min];
    
    const key = `${min}-${max}`;
    if(!memo[key]) {
        memo[key] = power[max] + getSum(power, min, max - 1, memo);
    }
    
    return memo[key];
}

/**
 * @param {number} n
 * @param {number[][]} queries
 * @return {number[]}
 */
var productQueries = function(n, queries) {
    const MOD = 10 ** 9 + 7;
    const memo = {};
    const powers = getPowers(n);
    const answers = [];
    console.log(powers.length);
    for(const [min, max] of queries) {
        answers.push(2 ** getSum(powers, min, max, memo) % MOD);
    }
    
    return answers;
};
```